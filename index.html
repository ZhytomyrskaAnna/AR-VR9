<!DOCTYPE html>
<html>
  <head>
    <title>–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ9: –í–ª–∞—Å–Ω—ñ –º–∞—Ä–∫–µ—Ä–∏ (–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ)</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.2.0/dist/aframe-extras.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–ª—ñ–∫—ñ–≤
      AFRAME.registerComponent('clickable', {
          init: function () {
              this.el.addEventListener('click', () => {
                  this.el.emit('clicked');
              });
          }
      });

      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –º—É–ª—å—Ç–∏-–∞–Ω—ñ–º–∞—Ü—ñ—î—é
      AFRAME.registerComponent('marker-animation-controller', {
          init: function () {
              const marker = this.el;
              const box = marker.querySelector('#animatedBox');
              let rotationAnimId = null;

              marker.addEventListener('markerFound', () => {
                  console.log('–ú–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ');
                  
                  // –ü–æ–∫–∞–∑—É—î–º–æ –æ–±'—î–∫—Ç
                  box.setAttribute('visible', 'true');
                  
                  // –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–±—ñ–ª—å—à–µ–Ω–Ω—è
                  box.setAttribute('animation__scale', {
                      property: 'scale',
                      from: '0 0 0',
                      to: '1 1 1',
                      dur: 500,
                      easing: 'easeOutElastic'
                  });

                  // –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø–æ—Å—Ç—ñ–π–Ω–µ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –ø—ñ—Å–ª—è –∑–±—ñ–ª—å—à–µ–Ω–Ω—è
                  setTimeout(() => {
                      box.setAttribute('animation__rotation', {
                          property: 'rotation',
                          from: '0 0 0',
                          to: '0 360 0',
                          dur: 2000,
                          easing: 'linear',
                          loop: true
                      });
                  }, 500);
              });

              marker.addEventListener('markerLost', () => {
                  console.log('–ú–∞—Ä–∫–µ—Ä –≤—Ç—Ä–∞—á–µ–Ω–æ');
                  
                  // –í–∏–¥–∞–ª—è—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
                  box.removeAttribute('animation__rotation');
                  
                  // –ê–Ω—ñ–º–∞—Ü—ñ—è –∑–º–µ–Ω—à–µ–Ω–Ω—è
                  box.setAttribute('animation__scale', {
                      property: 'scale',
                      from: '1 1 1',
                      to: '0 0 0',
                      dur: 300,
                      easing: 'easeInQuad'
                  });

                  // –•–æ–≤–∞—î–º–æ –ø—ñ—Å–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó
                  setTimeout(() => {
                      box.setAttribute('visible', 'false');
                      box.setAttribute('scale', '0 0 0');
                      box.setAttribute('rotation', '0 0 0'); // –°–∫–∏–¥–∞—î–º–æ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
                  }, 300);
              });
          }
      });
    </script>
  </head>
  <body style="margin: 0px; overflow: hidden;">
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

      <a-assets>
        <a-asset-item id="dragoniteModel" src="assets/dragonite_official.glb"></a-asset-item>
        <img id="phoneImg" src="assets/phone.jpg">
        <img id="emailImg" src="assets/gmail.jpg">
        <img id="youtubeImg" src="assets/youtube.jpg">
      </a-assets>

      <!-- –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è -->
      <a-light type="directional" 
        position="-5 5 -5" 
        intensity="1.5" 
        castShadow="true"
        shadow-mapSize="1024 1024"
        shadow-camera-near="0.5"
        shadow-camera-far="20"
        shadow-camera-left="-5"
        shadow-camera-right="5"
        shadow-camera-bottom="-5"
        shadow-camera-top="5">
      </a-light>
      <a-light type="ambient" color="#888"></a-light>

      <!-- –ú–∞—Ä–∫–µ—Ä –∑ 3D –º–æ–¥–µ–ª–ª—é -->
      <a-marker type="pattern" url="pattern-dragonite-marker.patt">
        <a-gltf-model src="#dragoniteModel"
            position="0 0 -5"
            scale="2 2 2"
            animation-mixer="clip: pm0149_00_00_00300_roar01; loop: repeat;"
            animation__rotate="property: rotation; to: 0 360 0; dur: 3000; easing: linear; loop: true"
            shadow="cast: true">
        </a-gltf-model>
      </a-marker>

      <!-- –ú–∞—Ä–∫–µ—Ä –∑ —ñ–∫–æ–Ω–∫–∞–º–∏ -->
      <a-marker type="pattern" url="pattern-my-marker">
        <a-image 
          id="phoneIcon" 
          src="#phoneImg" 
          position="-0.5 0 0" 
          scale="0.3 0.3 0.3" 
          class="clickable">
        </a-image>

        <a-image 
          id="emailIcon" 
          src="#emailImg" 
          position="0 0 0" 
          scale="0.3 0.3 0.3" 
          class="clickable">
        </a-image>

        <a-image 
          id="youtubeIcon" 
          src="#youtubeImg" 
          position="0.5 0 0" 
          scale="0.3 0.3 0.3" 
          class="clickable">
        </a-image>

        <a-text 
          id="infoText" 
          value="" 
          position="0 -0.5 0" 
          align="center" 
          color="black" 
          width="3">
        </a-text>
      </a-marker>

      <!-- –ú–∞—Ä–∫–µ—Ä –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é (–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞) -->
      <a-marker id="marker" type="pattern" url="pattern-marker-animation.patt" marker-animation-controller>
        <a-box id="animatedBox"
               position="0 0.5 0"
               color="#4CC3D9"
               scale="0 0 0"  
               visible="false">
        </a-box>
      </a-marker>

      <!-- –ö–∞–º–µ—Ä–∞ –∑ –∫—É—Ä—Å–æ—Ä–æ–º -->
      <a-entity camera>
        <a-cursor></a-cursor>
      </a-entity>
    </a-scene>

    <!-- –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—ñ–≤ –Ω–∞ —ñ–∫–æ–Ω–∫–∏ -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const infoText = document.querySelector('#infoText');

        document.querySelector('#phoneIcon').addEventListener('click', () => {
          infoText.setAttribute('value', 'üìû +380 68 070 34 57');
        });

        document.querySelector('#emailIcon').addEventListener('click', () => {
          infoText.setAttribute('value', '‚úâÔ∏è zhytomyreti@email.com');
        });

        document.querySelector('#youtubeIcon').addEventListener('click', () => {
          infoText.setAttribute('value', 'üîó https://www.youtube.com/@annazhytomyrska7541');
        });
      });
    </script>
  </body>
</html>